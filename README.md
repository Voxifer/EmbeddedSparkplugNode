# EmbeddedSparkplugNode Library Documentation

## Overview
This library is written in C and builds on top of the [BasicTag](https://github.com/mkeras/BasicTag) library to provide an easy to use API for creating tags, monitoring tags for changes, and enabling a microcontroller to operate as an Edge of Network Node according to the [Sparkplug Specification](https://sparkplug.eclipse.org/specification/version/3.0/documents/sparkplug-specification-3.0.0.pdf). This library is designed to perform all the neccessary operations of a Sparkplug Edge Node, but decoupled from any MQTT Library or other platform specific dependency for the purpose of maximum platform support. For the protobuf encoding/decoding operations, this library uses code generated by [nanoPB](https://jpa.kapsi.fi/nanopb/).

## Notes
- This library has not yet been thoroughly tested, it can be considered alpha (It's only my second C project, after BasicTag). Any feedback for bugs, suggestions, etc is appreciated.
- As noted in the overview, this library contains all the components to operate an edge of network node, but will need to be combined with an appropriate MQTT client library by the user. A full demonstration of this will be added to the example Arduino sketches in the near future.
- Sparkplug B, MQTT, and other related terms are trademarks of their respective owners. Any use of these terms in this project is for descriptive purposes only and does not imply any endorsement or affiliation.
- The current purpose of this library is to provide an open-source implementation of the Sparkplug B MQTT payload standard for hobbyist, educational and development uses.
- The documentation is not yet complete, further API documentation and examples will be added in the near future

## Data Structures



### `SparkplugNodeConfig`

Holds configuration for a Sparkplug node.

- **`node_id`**: `const char*` - Unique identifier for the node.
- **`group_id`**: `const char*` - Identifier for the group within which the node communicates.
- **`topics`**: `struct` - MQTT topics for node commands and data.
- **`node_tags`**: `struct` - Sparkplug tags associated with the node.
- **`vars`**: `struct` - Internal variables including tag values and MQTT connection state.

### `SparkplugNodeState`

Enumerates possible states of a Sparkplug node operation.

- **`spn_ERROR_NODE_NULL`**: Node configuration is null.
- **`spn_SCAN_NOT_DUE`**: No scan is due based on the current scan rate.
- **...**

## API Documentation

### `createSparkplugNode`

Initializes a new Sparkplug node.

```cpp
SparkplugNodeConfig* createSparkplugNode(const char* group_id, const char* node_id, size_t  payload_buffer_size, TimestampFunction timestamp_function);
```
